---
title: "Tedarik ZÄ°nciri Optimizasyonu"
output: html_document
---

*1.Proje TanÄ±mÄ± ve AmaÃ§*
Bu raporun amacÄ±, parakende satÄ±ÅŸ verileri Ä±ÅŸÄ±ÄŸÄ±nda tedarikÃ§i performanslarÄ±nÄ±
"satÄ±ÅŸ hacmi" ve "operasyonel lojistik yÃ¼kÃ¼" (transferler) ekseninde deÄŸerlendirmektedir.
Analiz sÃ¼recinde aÅŸaÄŸÄ±daki sorulara yanÄ±t aranmÄ±ÅŸtÄ±r:
 -Hangi TedarikÃ§iler ciroda liderdir, hangileri operasyonel yÃ¼k(transfer) yaratmaktadÄ±r.?
 -MaÄŸazalar arasÄ± Ã¼rÃ¼n transferleri satÄ±ÅŸÄ± arttÄ±rmakta mÄ±dÄ±r, yoksa sadece maliyet mi oluÅŸturmaktadÄ±r?
 -Verimsiz stok yÃ¶netimi yapan tedarikÃ§iler iÃ§in nasÄ±l bir aksiyon planÄ± oluÅŸturulmalÄ±dÄ±r?

*KullanÄ±lan Teknolojiler*:
 -R & Python: Ä°statistiksel modelleme ve gÃ¶rselleÅŸtirme (Interoperability).
 -SQL (SQLite): BÃ¼yÃ¼k veri manipÃ¼lasyonu ve agregasyon.

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

*2. Veri Seti HazÄ±rlÄ±ÄŸÄ± ve Ã–n Ä°ÅŸleme (Data Cleaning)*

Ham veri setinde (Raw Data) yer alan yapÄ±sal bozukluklar, analiz Ã¶ncesinde temizlenmiÅŸtir. Ã–zellikle sayÄ±sal olmasÄ± gereken sÃ¼tunlarda (SatÄ±ÅŸ, Transfer) tespit edilen metin karakterleri ("BC", "WC" vb.) temizlenmiÅŸ ve veri tipleri analize uygun hale getirilmiÅŸtir.

```{r, warning=FALSE, message=FALSE}

library(readxl)
library(janitor)
library(dplyr)
library(reticulate)
# Miniconda artik kurulu oldugu icin sadece paketleri istiyoruz
#py_install(c("pandas", "matplotlib", "seaborn"), pip = TRUE)
use_miniconda("r-reticulate", required = TRUE)
library(DBI)        #Sql 
library(RSQLite)    #Sql motoru
library(ggplot2)

retail <- read_excel("retail.xlsx")

retail <- retail %>%
  clean_names()
#gereksiz ve boÅŸ sÃ¼tunlarÄ±n silinme iÅŸlemi
if("x10" %in% names(retail)) {
  retail <- retail %>% select(-x10)
  } else if ("empty_column" %in% names(retail)) {
    retail <- retail %>% select(-empty_column)
    }
#Veri tiplerini dÃ¼zeltme(yazÄ±-> sayÄ± dÃ¶nÃ¼ÅŸÃ¼mÃ¼)
retail <- retail %>%
  mutate(
    # SatÄ±ÅŸ ve transferleri sayÄ±ya (numeric) Ã§evirme iÅŸlemi
    retail_sales = as.numeric(retail_sales),
    retail_transfers = as.numeric(retail_transfers),
    warehouse_sales = as.numeric(warehouse_sales),
    
    # YÄ±l ve Ay da sayÄ± olsun
    year = as.numeric(year),
    month = as.numeric(month)
  )

#dÃ¶nÃ¼ÅŸÃ¼m sonrasÄ± kontrol etme
glimpse(retail)
```

*3. TedarikÃ§i BazlÄ± Performans Analizi (SQL Aggregation)*

Veri seti satÄ±r bazlÄ± (iÅŸlem bazlÄ±) olduÄŸu iÃ§in, stratejik karar alabilmek adÄ±na veriyi TedarikÃ§i (Supplier) bazÄ±nda Ã¶zetlenmiÅŸtir. 

AÅŸaÄŸÄ±daki SQL sorgusu ile her bir tedarikÃ§i iÃ§in ÅŸu kritik KPI'lar hesaplanmÄ±ÅŸtÄ±r:
* *Toplam SatÄ±ÅŸ (Retail Sales):* TedarikÃ§inin yarattÄ±ÄŸÄ± ciro.
* *Ortalama Transfer (Avg Transfers):* ÃœrÃ¼nlerin maÄŸazalar arasÄ± dolaÅŸÄ±m sÄ±klÄ±ÄŸÄ± (Lojistik YÃ¼k).
* *ÃœrÃ¼n Ã‡eÅŸitliliÄŸi:* TedarikÃ§inin kaÃ§ farklÄ± Ã¼rÃ¼nÃ¼ (SKU) olduÄŸu.

```{r sql_baglantisi_kur}
#veriyi SQL ortamÄ±na gÃ¶nderme 
con <- dbConnect(RSQLite::SQLite(), ":memory:")
dbWriteTable(con, "retail_db", retail, overwrite=TRUE)

```

```{sql connection=con, output.var="sql_ozet"}
-- Veriyi analiz iÃ§in Ã¶zetliyoruz
SELECT 
    supplier, 
    item_type, 
    COUNT(*) as urun_sayisi,             -- KaÃ§ Ã§eÅŸit Ã¼rÃ¼n satmÄ±ÅŸ?
    SUM(retail_sales) as toplam_satis,   -- Toplam ne kadar satmÄ±ÅŸ?
    AVG(retail_transfers) as ortalama_transfer, -- ÃœrÃ¼nleri ne kadar transfer edilmiÅŸ?
    SUM(warehouse_sales) as depo_satis   -- Depodan ne kadar satmÄ±ÅŸ?
FROM retail_db
WHERE retail_sales > 0 
GROUP BY supplier, item_type
ORDER BY toplam_satis DESC

```

```{r}
head(sql_ozet)
```
*4. GÃ¶rselleÅŸtirme: SatÄ±ÅŸ GÃ¼cÃ¼ vs. Lojistik YÃ¼kÃ¼ (Python & Seaborn)*

TedarikÃ§ilerin performansÄ±nÄ± tek bir karede gÃ¶rebilmek iÃ§in veriyi Python (Seaborn) kÃ¼tÃ¼phanesi kullanarak gÃ¶rselleÅŸtirdik. Bu "Bubble Chart" (Balon GrafiÄŸi) bize 3 boyutlu bir analiz sunar:

1.  *X Ekseni (Yatay):* Operasyonel YÃ¼k (Ortalama Transfer SayÄ±sÄ±). SaÄŸa gidildikÃ§e lojistik maliyet artar.
2.  *Y Ekseni (Dikey):* Ciro (Toplam SatÄ±ÅŸ). YukarÄ± gidildikÃ§e kasa dolar.
3.  *Balon BÃ¼yÃ¼klÃ¼ÄŸÃ¼:* Depo SatÄ±ÅŸ Hacmi. Stok derinliÄŸini gÃ¶sterir.
Hedef BÃ¶lge: Sol Ãœst KÃ¶ÅŸe (DÃ¼ÅŸÃ¼k Transfer, YÃ¼ksek SatÄ±ÅŸ).

```{python bubble_chart}
import pandas as pd
import matplotlib
matplotlib.use('Agg') 
import matplotlib.pyplot as plt
import seaborn as sns

plt.clf()

# 1. Veriyi Al
df = r.sql_ozet

# 2. Grafik Alani Ayarlari
sns.set_theme(style="whitegrid")
# Figur boyutunu genisletiyoruz (Bosluklar icin)
plt.figure(figsize=(13, 9)) 

# 3. Balon Grafigi
grafik = sns.scatterplot(
    data=df.head(15), 
    x="ortalama_transfer", 
    y="toplam_satis", 
    size="depo_satis", 
    hue="item_type",      
    sizes=(200, 2000),    
    alpha=0.7,            
    palette="viridis"     
)

# 4. Baslik ve Eksen Yazilari
# Basligi biraz yukari ittik
plt.title("Analiz Sonucu: Satis Gucu vs. Lojistik Yuku", fontsize=16, pad=20) 
# Alt yaziyi biraz asagi ittik
plt.xlabel("Ortalama Transfer Sayisi (Operasyonel Yuk)", fontsize=12, labelpad=15) 
plt.ylabel("Toplam Satis Tutari (Ciro)", fontsize=12)

# --- DUZELTME BURADA ---
# Legend (Aciklama Kutusu) Ayari:
# Kutuyu grafigin sagina aliyoruz
plt.legend(bbox_to_anchor=(1.02, 1), loc='upper left', borderaxespad=0, title="Urun Tipi")

# Not Ekleme (Konumu guvenli yere aldik)
plt.text(x=df['ortalama_transfer'].min(), 
         y=df['toplam_satis'].max(), 
         s="  YILDIZ BOLGE\n(Cok Satis, Az Transfer)", 
         color='green', weight='bold', fontsize=11)

# EN ONEMLI KISIM: Kenar Bosluklari
# Alttan (bottom) ve sagdan (right) pay birakiyoruz ki yazilar kesilmesin.
plt.subplots_adjust(bottom=0.15, right=0.80, top=0.90)

plt.show()
```

*5. Ä°statistiksel Modelleme ve Hipotez Testi*

GÃ¶rselleÅŸtirmede fark edilen "Transfer arttÄ±kÃ§a satÄ±ÅŸ da artÄ±yor" eÄŸilimini matematiksel olarak kanÄ±tlamak iÃ§in **Basit DoÄŸrusal Regresyon (Linear Regression)** modeli kurulmuÅŸtur.

* *BaÄŸÄ±mlÄ± DeÄŸiÅŸken (Y):* Toplam SatÄ±ÅŸ (Ciro)
* *BaÄŸÄ±msÄ±z DeÄŸiÅŸken (X):* Ortalama Transfer (Lojistik YÃ¼k)

Bu model, transfer trafiÄŸindeki artÄ±ÅŸÄ±n satÄ±ÅŸlara olan "net etkisini" ($R^2$ ve P-deÄŸeri ile) Ã¶lÃ§memizi saÄŸlar.
Modelin temel parametreleri ve yorumlarÄ± aÅŸaÄŸÄ±dadÄ±r:

#### A) KatsayÄ±larÄ±n Yorumu (Coefficients)

1.  *EÄŸim (Slope - `ortalama_transfer`): +4,709*
    * *Ä°statistiksel Anlam:* Ortalama transfer sayÄ±sÄ±ndaki her *1 birimlik artÄ±ÅŸ*, toplam satÄ±ÅŸlarda yaklaÅŸÄ±k *4,709 birimlik bir artÄ±ÅŸa* neden olmaktadÄ±r.
    * *Yorum:* Transferler ile satÄ±ÅŸlar arasÄ±nda *Pozitif (+) Korelasyon** vardÄ±r. Yani transfer yapmak satÄ±ÅŸÄ± dÃ¼ÅŸÃ¼rmemiÅŸ, aksine (talebi karÅŸÄ±ladÄ±ÄŸÄ± iÃ§in) artÄ±rmÄ±ÅŸtÄ±r.

2.  *P-DeÄŸeri (Significance): $0.000226$ ($p < 0.001$)*
    * Model sonucunda `p-value` deÄŸeri 0.05'ten (hatta 0.001'den) Ã§ok kÃ¼Ã§Ã¼ktÃ¼r.
    * *Yorum:* BulduÄŸumuz bu iliÅŸki *%99.9 gÃ¼ven aralÄ±ÄŸÄ±nda* anlamlÄ±dÄ±r. Yani bu sonuÃ§ ÅŸans eseri oluÅŸmamÄ±ÅŸtÄ±r; transfer trafiÄŸi ile ciro arasÄ±nda matematiksel olarak kesin bir baÄŸ vardÄ±r.

3.  *Sabit DeÄŸer (Intercept): 4,676,673*
    * Transfer sayÄ±sÄ± "0" olsa bile, bir tedarikÃ§inin ortalama beklenen satÄ±ÅŸ hacmi yaklaÅŸÄ±k 4.6 Milyon birimdir. Bu, markalarÄ±n kendi organik gÃ¼cÃ¼nÃ¼ gÃ¶sterir.

B) Modelin AÃ§Ä±klayÄ±cÄ±lÄ±k GÃ¼cÃ¼ ($R^2$)

* *R-Squared DeÄŸeri:* 0.027 (%2.7)
* *Analiz:* Kurulan model, satÄ±ÅŸlardaki deÄŸiÅŸimin %2.7'sini transferler ile aÃ§Ä±klayabilmektedir.
* *Kritik Ã‡Ä±karÄ±m:* R-kare deÄŸerinin dÃ¼ÅŸÃ¼k olmasÄ±, satÄ±ÅŸlarÄ± etkileyen tek faktÃ¶rÃ¼n transfer olmadÄ±ÄŸÄ±nÄ± gÃ¶sterir (Fiyat, marka bilinirliÄŸi, sezonluk etkiler vb. asÄ±l belirleyicidir). Ancak *P-deÄŸerinin Ã§ok anlamlÄ± Ã§Ä±kmasÄ±*, etkinin kÃ¼Ã§Ã¼k de olsa "gÃ¶z ardÄ± edilemez" olduÄŸunu kanÄ±tlar.

---
*ğŸ“‰ Ä°statistiksel Karar:*
YapÄ±lan t-testi sonucunda H=0 (Etkisiz Hipotez) reddedilmiÅŸtir. MaÄŸazalar arasÄ± transferlerin satÄ±ÅŸ performansÄ± Ã¼zerinde *pozitif ve anlamlÄ±* bir etkisi olduÄŸu doÄŸrulanmÄ±ÅŸtÄ±r.

```{r model_analizi}
# 1. Modeli Kuruyoruz (Basit DoÄŸrusal Regresyon)
# BaÄŸÄ±mlÄ± DeÄŸiÅŸken (Y): Toplam SatÄ±ÅŸ (Ciro)
# BaÄŸÄ±msÄ±z DeÄŸiÅŸken (X): Ortalama Transfer (Lojistik YÃ¼k)
model <- lm(toplam_satis ~ ortalama_transfer, data = sql_ozet)

# 2. Model SonuÃ§larÄ±nÄ± Ekrana BasÄ±yoruz
summary(model)

# 3. Modelin GÃ¼venilirliÄŸi (TanÄ± Grafikleri)
# Hata terimlerinin daÄŸÄ±lÄ±mÄ±, deÄŸiÅŸen varyans vb. kontrolÃ¼
par(mfrow=c(2,2)) # 4 grafiÄŸi bir arada gÃ¶ster
plot(model)
```


*6. Analiz BulgularÄ±, SonuÃ§ ve Stratejik Yol HaritasÄ±*

Bu Ã§alÄ±ÅŸmada elde edilen bulgular, *Ä°statistiksel KanÄ±tlar*, *Saha YansÄ±malarÄ±* ve *Aksiyon PlanÄ±* olmak Ã¼zere Ã¼Ã§ aÅŸamada Ã¶zetlenmiÅŸtir.

A) Ä°statistiksel Model SonuÃ§larÄ± (Matematiksel KanÄ±t)
Kurulan doÄŸrusal regresyon modeli sonucunda, *Transfer SayÄ±sÄ±* ile *SatÄ±ÅŸlar* arasÄ±nda istatistiksel olarak anlamlÄ± (p < 0.001) ve *pozitif* yÃ¶nlÃ¼ bir iliÅŸki tespit edilmiÅŸtir.

* *KatsayÄ± Yorumu:* Transfer sayÄ±sÄ±ndaki her 1 birimlik artÄ±ÅŸ, ortalama satÄ±ÅŸÄ± yaklaÅŸÄ±k *4,709 birim* artÄ±rmaktadÄ±r.
* *Bulgunun AnlamÄ±:* Beklentinin aksine, transferlerin satÄ±ÅŸÄ± dÃ¼ÅŸÃ¼rmediÄŸi gÃ¶rÃ¼lmÃ¼ÅŸtÃ¼r. Ancak bu durum saÄŸlÄ±klÄ± bir bÃ¼yÃ¼me deÄŸil, *"Zorunlu Operasyon"* iÅŸaretidir. Ã‡ok talep gÃ¶ren Ã¼rÃ¼nler, doÄŸru maÄŸazaya ilk seferde gÃ¶nderilemediÄŸi iÃ§in maÄŸazalar arasÄ± transfer trafiÄŸi (mekik diplomasisi) ile aÃ§Ä±k kapatÄ±lmaya Ã§alÄ±ÅŸÄ±lmaktadÄ±r.

B) TedarikÃ§i Ekosistemi Analizi (Vaka Ã‡alÄ±ÅŸmasÄ±)
Veri seti tedarikÃ§i bazÄ±nda incelendiÄŸinde, bu verimsizliÄŸin kaynaÄŸÄ± netleÅŸmektedir. Ekosistemimiz iki ana profilde Ã§alÄ±ÅŸmaktadÄ±r:

*1. Hacim Lideri Ancak YÃ¼ksek Riskli: "E & J GALLO WINERY"*
* *Durum:* YaklaÅŸÄ±k *190 Milyon birim* satÄ±ÅŸ ile cironun tartÄ±ÅŸmasÄ±z lideridir. Ancak *1012 puanlÄ±k* Ortalama Transfer Skoru ile operasyonel olarak en maliyetli iÅŸ ortaÄŸÄ±mÄ±zdÄ±r.
* *Sorun:* Bu tedarikÃ§inin Ã¼rÃ¼nleri maÄŸazalara doÄŸru daÄŸÄ±tÄ±lamamaktadÄ±r. ÃœrÃ¼nler sÃ¼rekli yolda gezmektedir.
* *SonuÃ§:* Ciro yÃ¼ksek olsa da, lojistik maliyetler ve personel eforu kÃ¢rlÄ±lÄ±ÄŸÄ± eritmektedir.

*2. Verimlilik Åampiyonu (Benchmark): "REPUBLIC NATIONAL DISTRIBUTING CO"*
* *Durum:* *113 Milyon birim* ile Ã§ok yÃ¼ksek bir hacme sahip olmasÄ±na raÄŸmen, Ortalama Transfer Skoru sadece **253'tÃ¼r**.
* **BaÅŸarÄ±:** Bu tedarikÃ§i *"DoÄŸru ÃœrÃ¼n, DoÄŸru MaÄŸaza"* ilkesine en uygun Ã§alÄ±ÅŸan iÅŸ ortaÄŸÄ±dÄ±r. ÃœrÃ¼nleri maÄŸazaya girdiÄŸi gibi satÄ±lmakta, ekstra transfer gerektirmemektedir.

---

ğŸš€ C) Stratejik Yol HaritasÄ± (Aksiyon PlanÄ±)

Model sonuÃ§larÄ± ve tedarikÃ§i kÄ±yaslamalarÄ± Ä±ÅŸÄ±ÄŸÄ±nda aÅŸaÄŸÄ±daki aksiyonlar alÄ±nmalÄ±dÄ±r:

1.  *Hedef:* E & J Gallo firmasÄ±ndan vazgeÃ§emeyiz (Ciro lideri). Ancak operasyonel verimsizliÄŸini kabul de edemeyiz.

2.  *Aksiyon:* Republic National firmasÄ±nÄ±n lojistik ve daÄŸÄ±tÄ±m stratejisi (Allocation Strategy) incelenmeli ve bu verimli model E & J Gallo operasyonlarÄ±na uygulanmalÄ±dÄ±r.

3.  *Tahmin:* EÄŸer E & J Gallo'nun transfer oranlarÄ±nÄ± (1012'den), Republic seviyelerine (250 bandÄ±na) Ã§ekebilirsek; satÄ±ÅŸ hacmi sabit kalsa bile 
*lojistik tasarruftan dolayÄ± net kÃ¢rlÄ±lÄ±ÄŸÄ±mÄ±z ciddi oranda artacaktÄ±r.*